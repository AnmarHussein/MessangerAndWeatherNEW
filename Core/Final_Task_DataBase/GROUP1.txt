create table Group1(
ID NUMBER GENERATED BY DEFAULT AS IDENTITY CONSTRAINT PK_group1 PRIMARY Key,
name varchar2(255),
createat date,
userid NUMBER CONSTRAINT KF_GROUP1_USER1 REFERENCES USER1(ID) ON DELETE CASCADE

);
CREATE OR REPLACE PACKAGE  Group1_PACKAGE AS

    PROCEDURE Group1_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_NAME IN VARCHAR DEFAULT NULL
    ,P_CREATEAT IN DATE DEFAULT NULL
    ,P_USERID IN VARCHAR DEFAULT NULL);
    
End Group1_PACKAGE;



CREATE OR REPLACE PACKAGE BODY Group1_PACKAGE AS
    
    PROCEDURE Group1_CRUD(P_ACTION in varchar DEFAULT NULL 
    ,P_ID IN NUMBER DEFAULT NULL
    ,P_NAME IN VARCHAR DEFAULT NULL
    ,P_CREATEAT IN DATE DEFAULT NULL
    ,P_USERID IN VARCHAR DEFAULT NULL)
    IS
        group_all SYS_REFCURSOR;
    BEGIN
        IF P_ACTION = 'INSERT' THEN
            INSERT INTO group1 VALUES(DEFAULT,P_NAME,TO_Date(P_CREATEAT , 'dd-mm-yyyy'),P_USERID); 
            COMMIT;
        ELSIF P_ACTION = 'UPDATE' THEN

            UPDATE group1 SET
                NAME = P_NAME , 
                CREATEAT = TO_Date(P_CREATEAT , 'dd-mm-yyyy'),
                USERID = P_USERID
            WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'DELETE' THEN
            DELETE group1 WHERE ID = P_ID;
            COMMIT;

        ELSIF P_ACTION = 'GETALL' THEN
            OPEN group_all FOR SELECT * FROM group1;
            dbms_sql.return_result(group_all);

        ELSIF P_ACTION = 'GETBYID' THEN
            OPEN group_all FOR SELECT * FROM group1 WHERE ID = P_ID;
            dbms_sql.return_result(group_all);
        END IF;
    END Group1_CRUD;

END Group1_PACKAGE;